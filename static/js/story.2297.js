(function(define){(function(){!function(e,t,n){"use strict";var r,a,l,i={minHeight:0,elements:[],percentage:!0,userTiming:!0,pixelDepth:!0},o=e(t),c=[],u=0;e.scrollDepth=function(h){function p(e,t,n,i){l?(dataLayer.push({event:"ScrollDistance",eventCategory:"Scroll Depth",eventAction:e,eventLabel:t,eventValue:1,eventNonInteraction:!0}),h.pixelDepth&&arguments.length>2&&n>u&&(u=n,dataLayer.push({event:"ScrollDistance",eventCategory:"Scroll Depth",eventAction:"Pixel Depth",eventLabel:f(n),eventValue:1,eventNonInteraction:!0})),h.userTiming&&arguments.length>3&&dataLayer.push({event:"ScrollTiming",eventCategory:"Scroll Depth",eventAction:e,eventLabel:t,eventTiming:i})):(r&&(ga("send","event","Scroll Depth",e,t,1,{nonInteraction:1}),h.pixelDepth&&arguments.length>2&&n>u&&(u=n,ga("send","event","Scroll Depth","Pixel Depth",f(n),1,{nonInteraction:1})),h.userTiming&&arguments.length>3&&ga("send","timing","Scroll Depth",e,i,t)),a&&(_gaq.push(["_trackEvent","Scroll Depth",e,t,1,!0]),h.pixelDepth&&arguments.length>2&&n>u&&(u=n,_gaq.push(["_trackEvent","Scroll Depth","Pixel Depth",f(n),1,!0])),h.userTiming&&arguments.length>3&&_gaq.push(["_trackTiming","Scroll Depth",e,i,t,100])))}function g(e){return{"25%":parseInt(.25*e,10),"50%":parseInt(.5*e,10),"75%":parseInt(.75*e,10),"100%":e-5}}function s(t,n,r){e.each(t,function(t,a){-1===e.inArray(t,c)&&n>=a&&(p("Percentage",t,n,r),c.push(t))})}function v(t,n,r){e.each(t,function(t,a){-1===e.inArray(a,c)&&e(a).length&&n>=e(a).offset().top&&(p("Elements",a,n,r),c.push(a))})}function f(e){return(250*Math.floor(e/250)).toString()}function m(e,t){var n,r,a,l=null,i=0,o=function(){i=new Date,l=null,a=e.apply(n,r)};return function(){var c=new Date;i||(i=c);var u=t-(c-i);return n=this,r=arguments,0>=u?(clearTimeout(l),l=null,i=c,a=e.apply(n,r)):l||(l=setTimeout(o,u)),a}}var D=+new Date;h=e.extend({},i,h),e(n).height()<h.minHeight||("function"==typeof ga&&(r=!0),"undefined"!=typeof _gaq&&"function"==typeof _gaq.push&&(a=!0),"undefined"!=typeof dataLayer&&"function"==typeof dataLayer.push&&(l=!0),p("Percentage","Baseline"),o.on("scroll.scrollDepth",m(function(){var r=e(n).height(),a=t.innerHeight?t.innerHeight:o.height(),l=o.scrollTop()+a,i=g(r),u=+new Date-D;return c.length>=4+h.elements.length?void o.off("scroll.scrollDepth"):(h.elements&&v(h.elements,l,u),void(h.percentage&&s(i,l,u)))},500)))}}(jQuery,window,document);(function(window,document){"use strict";var bgLoad;var uniqueUrls={};if(document.addEventListener){bgLoad=function(url,cb){var img=document.createElement("img");img.onload=function(){img.onload=null;img.onerror=null;img=null;cb()};img.onerror=img.onload;img.src=url;if(img&&img.complete&&img.onload){img.onload()}};addEventListener("lazybeforeunveil",function(e){var tmp,load,bg,poster;if(!e.defaultPrevented){if(e.target.preload=="none"){e.target.preload="auto"}tmp=e.target.getAttribute("data-link");if(tmp){addStyleScript(tmp,true)}tmp=e.target.getAttribute("data-script");if(tmp){addStyleScript(tmp)}tmp=e.target.getAttribute("data-require");if(tmp){if(window.require){require([tmp])}}bg=e.target.getAttribute("data-bg");if(bg){e.detail.firesLoad=true;load=function(){e.target.style.backgroundImage="url("+bg+")";e.detail.firesLoad=false;lazySizes.fire(e.target,"_lazyloaded",{},true,true)};bgLoad(bg,load)}poster=e.target.getAttribute("data-poster");if(poster){e.detail.firesLoad=true;load=function(){e.target.poster=poster;e.detail.firesLoad=false;lazySizes.fire(e.target,"_lazyloaded",{},true,true)};bgLoad(poster,load)}}},false)}function addStyleScript(src,style){if(uniqueUrls[src]){return}var elem=document.createElement(style?"link":"script");var insertElem=document.getElementsByTagName("script")[0];if(style){elem.rel="stylesheet";elem.href=src}else{elem.src=src}uniqueUrls[src]=true;uniqueUrls[elem.src||elem.href]=true;insertElem.parentNode.insertBefore(elem,insertElem)}})(window,document);(function(){"use strict";if(!window.addEventListener){return}var regSplitSet=/\s*\|\s+|\s+\|\s*/g;var regSource=/^(.+?)(?:\s+\[\s*(.+?)\s*\])?$/;var allowedBackgroundSize={contain:1,cover:1};var proxyWidth=function(elem){var width=lazySizes.gW(elem,elem.parentNode);if(!elem._lazysizesWidth||width>elem._lazysizesWidth){elem._lazysizesWidth=width}return elem._lazysizesWidth};var createPicture=function(sets,elem,img){var picture=document.createElement("picture");var sizes=elem.getAttribute(lazySizesConfig.sizesAttr);var optimumx=elem.getAttribute("data-optimumx");var bgSize=(getComputedStyle(elem)||{getPropertyValue:function(){}}).getPropertyValue("background-size");if(allowedBackgroundSize[bgSize]&&(sizes=="auto"||!sizes)){img.setAttribute("data-parent-fit",bgSize);sizes="auto"}if(elem._lazybgset&&elem._lazybgset.parentNode==elem){elem.removeChild(elem._lazybgset)}Object.defineProperty(img,"_lazybgset",{value:elem,writable:true});Object.defineProperty(elem,"_lazybgset",{value:picture,writable:true});sets=sets.split(regSplitSet);picture.style.display="none";img.className=lazySizesConfig.lazyClass;if(sets.length==1&&!sizes){sizes="auto"}sets.forEach(function(set){var source=document.createElement("source");if(sizes&&sizes!="auto"){source.setAttribute("sizes",sizes)}if(set.match(regSource)){source.setAttribute(lazySizesConfig.srcsetAttr,RegExp.$1);if(RegExp.$2){source.setAttribute("media",lazySizesConfig.customMedia[RegExp.$2]||RegExp.$2)}}picture.appendChild(source)});if(sizes){img.setAttribute(lazySizesConfig.sizesAttr,sizes);elem.removeAttribute(lazySizesConfig.sizesAttr);elem.removeAttribute("sizes")}if(optimumx){img.setAttribute("data-optimumx",optimumx)}picture.appendChild(img);elem.appendChild(picture)};var proxyLoad=function(e){if(!e.target._lazybgset){return}var image=e.target;var elem=image._lazybgset;var bg=image.currentSrc||image.src;if(bg){elem.style.backgroundImage="url("+bg+")"}if(image._lazybgsetLoading){lazySizes.fire(elem,"_lazyloaded",{},false,true);delete image._lazybgsetLoading}};addEventListener("lazybeforeunveil",function(e){var set,image,elem;if(e.defaultPrevented||!(set=e.target.getAttribute("data-bgset"))){return}elem=e.target;image=document.createElement("img");image._lazybgsetLoading=true;e.detail.firesLoad=true;createPicture(set,elem,image);lazySizes.loader.unveil(image);lazySizes.fire(image,"_lazyloaded",{},true,true);setTimeout(function(){if(image.complete){proxyLoad({target:image})}})});document.addEventListener("load",proxyLoad,true);document.documentElement.addEventListener("lazybeforesizes",function(e){if(e.defaultPrevented||!e.target._lazybgset){return}e.detail.width=proxyWidth(e.target._lazybgset)})})();(function(window,document,undefined){"use strict";var polyfill;var config=window.lazySizes&&lazySizes.cfg||window.lazySizesConfig;if(!config){config={};window.lazySizesConfig=config}if(!config.supportsType){config.supportsType=function(type){return!type}}if(window.picturefill||window.respimage||config.pf){return}config.pf=function(options){var i,len;if(window.picturefill||window.respimage){return}for(i=0,len=options.elements.length;i<len;i++){polyfill(options.elements[i])}};polyfill=function(){var ascendingSort=function(a,b){return a.w-b.w};var regPxLength=/^\s*\d+px\s*$/;var reduceCandidate=function(srces){var lowerCandidate,bonusFactor;var len=srces.length;var candidate=srces[len-1];var i=0;for(i;i<len;i++){candidate=srces[i];candidate.d=candidate.w/srces.w;if(candidate.d>=srces.d){if(!candidate.cached&&(lowerCandidate=srces[i-1])&&lowerCandidate.d>srces.d-.13*Math.pow(srces.d,2.2)){bonusFactor=Math.pow(lowerCandidate.d-.6,1.6);if(lowerCandidate.cached){lowerCandidate.d+=.15*bonusFactor}if(lowerCandidate.d+(candidate.d-srces.d)*bonusFactor>srces.d){candidate=lowerCandidate}}break}}return candidate};var parseWsrcset=function(){var candidates;var regWCandidates=/(([^,\s].[^\s]+)\s+(\d+)w)/g;var regHDesc=/\s+\d+h/g;var regMultiple=/\s/;var addCandidate=function(match,candidate,url,wDescriptor){candidates.push({c:candidate,u:url,w:wDescriptor*1})};return function(input){candidates=[];input=input.trim();input.replace(regHDesc,"").replace(regWCandidates,addCandidate);if(!candidates.length&&input&&!regMultiple.test(input)){candidates.push({c:input,u:input,w:99})}return candidates}}();var runMatchMedia=function(){if(runMatchMedia.init){return}runMatchMedia.init=true;addEventListener("resize",function(){var timer;var matchMediaElems=document.getElementsByClassName("lazymatchmedia");var run=function(){var i,len;for(i=0,len=matchMediaElems.length;i<len;i++){polyfill(matchMediaElems[i])}};return function(){clearTimeout(timer);timer=setTimeout(run,66)}}())};var createSrcset=function(elem,isImage){var parsedSet;var srcSet=elem.getAttribute("srcset")||elem.getAttribute(config.srcsetAttr);if(!srcSet&&isImage){srcSet=!elem._lazypolyfill?elem.getAttribute("src")||elem.getAttribute(config.srcAttr):elem._lazypolyfill._set}if(!elem._lazypolyfill||elem._lazypolyfill._set!=srcSet){parsedSet=parseWsrcset(srcSet||"");if(isImage&&elem.parentNode){parsedSet.isPicture=elem.parentNode.nodeName.toUpperCase()=="PICTURE";if(parsedSet.isPicture&&elem.getAttribute(config.sizesAttr)!="auto"){if(window.matchMedia||window.Modernizr&&Modernizr.mq){lazySizes.aC(elem,"lazymatchmedia");runMatchMedia()}}}parsedSet._set=srcSet;Object.defineProperty(elem,"_lazypolyfill",{value:parsedSet,writable:true})}};var getX=function(elem){var dpr=window.devicePixelRatio||1;var optimum=lazySizes.getX&&lazySizes.getX(elem);return Math.min(optimum||dpr,2.5,dpr)};var matchesMedia=function(media){if(window.matchMedia){matchesMedia=function(media){return!media||(matchMedia(media)||{}).matches}}else if(window.Modernizr&&Modernizr.mq){return!media||Modernizr.mq(media)}else{return!media}return matchesMedia(media)};var getCandidate=function(elem){var sources,i,len,media,source,srces,src,width;source=elem;createSrcset(source,true);srces=source._lazypolyfill;if(srces.isPicture){for(i=0,sources=elem.parentNode.getElementsByTagName("source"),len=sources.length;i<len;i++){if(config.supportsType(sources[i].getAttribute("type"),elem)&&matchesMedia(sources[i].getAttribute("media"))){source=sources[i];createSrcset(source);srces=source._lazypolyfill;break}}}if(srces.length>1){width=source.getAttribute("sizes")||"";width=regPxLength.test(width)&&parseInt(width,10)||lazySizes.gW(elem,elem.parentNode);srces.d=getX(elem);if(!srces.w||srces.w<width){srces.w=width;src=reduceCandidate(srces.sort(ascendingSort))}}else{src=srces[0]}return src};var p=function(elem){var candidate=getCandidate(elem);if(candidate&&candidate.u&&elem._lazypolyfill.cur!=candidate.u){elem._lazypolyfill.cur=candidate.u;candidate.cached=true;elem.setAttribute(config.srcAttr,candidate.u);elem.setAttribute("src",candidate.u)}};p.parse=parseWsrcset;return p}();if(window.HTMLPictureElement){return}if(config.loadedClass&&config.loadingClass){(function(){var sels=[];['img[sizes$="px"][srcset].',"picture > img:not([srcset])."].forEach(function(sel){sels.push(sel+config.loadedClass);sels.push(sel+config.loadingClass)});config.pf({elements:document.querySelectorAll(sels.join(", "))})})()}})(window,document);(function(document){"use strict";var regPicture;var img=document.createElement("img");if("srcset"in img&&!("sizes"in img)){regPicture=/^picture$/i;document.addEventListener("lazybeforeunveil",function(e){var elem,parent,srcset,sizes,isPicture;var picture,source;if(e.defaultPrevented||lazySizesConfig.noIOSFix||!(elem=e.target)||!(srcset=elem.getAttribute(lazySizesConfig.srcsetAttr))||!(parent=elem.parentNode)||!(isPicture=regPicture.test(parent.nodeName||""))&&!(sizes=elem.getAttribute("sizes")||elem.getAttribute(lazySizesConfig.sizesAttr))){return}picture=isPicture?parent:document.createElement("picture");if(!elem._lazyImgSrc){Object.defineProperty(elem,"_lazyImgSrc",{value:document.createElement("source"),writable:true})}source=elem._lazyImgSrc;if(sizes){source.setAttribute("sizes",sizes)}source.setAttribute(lazySizesConfig.srcsetAttr,srcset);elem.setAttribute("data-pfsrcset",srcset);elem.removeAttribute(lazySizesConfig.srcsetAttr);if(!isPicture){parent.insertBefore(picture,elem);picture.appendChild(elem)}picture.insertBefore(source,elem)})}})(document);(function(window,factory){var lazySizes=factory(window,window.document);window.lazySizes=lazySizes;if(typeof module=="object"&&module.exports){module.exports=lazySizes}else if(typeof define=="function"&&define.amd){define(lazySizes)}})(window,function(window,document){"use strict";if(!document.getElementsByClassName){return}var lazySizesConfig;var docElem=document.documentElement;var addEventListener=window.addEventListener;var setTimeout=window.setTimeout;var rAF=window.requestAnimationFrame||setTimeout;var setImmediate=window.setImmediate||setTimeout;var regPicture=/^picture$/i;var loadEvents=["load","error","lazyincluded","_lazyloaded"];var hasClass=function(ele,cls){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");return ele.className.match(reg)&&reg};var addClass=function(ele,cls){if(!hasClass(ele,cls)){ele.className+=" "+cls}};var removeClass=function(ele,cls){var reg;if(reg=hasClass(ele,cls)){ele.className=ele.className.replace(reg," ")}};var addRemoveLoadEvents=function(dom,fn,add){var action=add?"addEventListener":"removeEventListener";if(add){addRemoveLoadEvents(dom,fn)}loadEvents.forEach(function(evt){dom[action](evt,fn)})};var triggerEvent=function(elem,name,detail,noBubbles,noCancelable){var event=document.createEvent("CustomEvent");event.initCustomEvent(name,!noBubbles,!noCancelable,detail||{});elem.dispatchEvent(event);return event};var updatePolyfill=function(el,full){var polyfill;if(!window.HTMLPictureElement){if(polyfill=window.picturefill||window.respimage||lazySizesConfig.pf){polyfill({reevaluate:true,elements:[el]})}else if(full&&full.src){el.src=full.src}}};var getCSS=function(elem,style){return(getComputedStyle(elem,null)||{})[style]};var getWidth=function(elem,parent,width){width=width||elem.offsetWidth;while(width<lazySizesConfig.minSize&&parent&&!elem._lazysizesWidth){width=parent.offsetWidth;parent=parent.parentNode}return width};var throttle=function(fn){var running;var lastTime=0;var Date=window.Date;var run=function(){running=false;lastTime=Date.now();fn()};var afterAF=function(){setImmediate(run)};var getAF=function(){rAF(afterAF)};return function(){if(running){return}var delay=lazySizesConfig.throttle-(Date.now()-lastTime);running=true;if(delay<6){delay=6}setTimeout(getAF,delay)}};var loader=function(){var lazyloadElems,preloadElems,isCompleted,resetPreloadingTimer,loadMode;var eLvW,elvH,eLtop,eLleft,eLright,eLbottom;var defaultExpand,preloadExpand;var regImg=/^img$/i;var regIframe=/^iframe$/i;var supportScroll="onscroll"in window&&!/glebot/.test(navigator.userAgent);var shrinkExpand=0;var currentExpand=0;var isLoading=0;var lowRuns=0;var resetPreloading=function(e){isLoading--;if(e&&e.target){addRemoveLoadEvents(e.target,resetPreloading)}if(!e||isLoading<0||!e.target){isLoading=0}};var isNestedVisible=function(elem,elemExpand){var outerRect;var parent=elem;var visible=getCSS(elem,"visibility")!="hidden";eLtop-=elemExpand;eLbottom+=elemExpand;eLleft-=elemExpand;eLright+=elemExpand;while(visible&&(parent=parent.offsetParent)){visible=(getCSS(parent,"opacity")||1)>0;if(visible&&getCSS(parent,"overflow")!="visible"){outerRect=parent.getBoundingClientRect();visible=eLright>outerRect.left&&eLleft<outerRect.right&&eLbottom>outerRect.top-1&&eLtop<outerRect.bottom+1}}return visible};var checkElements=function(){var eLlen,i,rect,autoLoadElem,loadedSomething,elemExpand,elemNegativeExpand,elemExpandVal,beforeExpandVal;if((loadMode=lazySizesConfig.loadMode)&&isLoading<8&&(eLlen=lazyloadElems.length)){i=0;lowRuns++;if(currentExpand<preloadExpand&&isLoading<1&&lowRuns>3&&loadMode>2){currentExpand=preloadExpand;lowRuns=0}else if(loadMode>1&&lowRuns>2&&isLoading<6){currentExpand=defaultExpand}else{currentExpand=shrinkExpand}for(;i<eLlen;i++){if(!lazyloadElems[i]||lazyloadElems[i]._lazyRace){continue}if(!supportScroll){unveilElement(lazyloadElems[i]);continue}if(!(elemExpandVal=lazyloadElems[i].getAttribute("data-expand"))||!(elemExpand=elemExpandVal*1)){elemExpand=currentExpand}if(beforeExpandVal!==elemExpand){eLvW=innerWidth+elemExpand;elvH=innerHeight+elemExpand;elemNegativeExpand=elemExpand*-1;beforeExpandVal=elemExpand}rect=lazyloadElems[i].getBoundingClientRect();if((eLbottom=rect.bottom)>=elemNegativeExpand&&(eLtop=rect.top)<=elvH&&(eLright=rect.right)>=elemNegativeExpand&&(eLleft=rect.left)<=eLvW&&(eLbottom||eLright||eLleft||eLtop)&&(isCompleted&&isLoading<3&&!elemExpandVal&&(loadMode<3||lowRuns<4)||isNestedVisible(lazyloadElems[i],elemExpand))){unveilElement(lazyloadElems[i]);loadedSomething=true;if(isLoading>12){break}if(isLoading>7){currentExpand=shrinkExpand}}else if(!loadedSomething&&isCompleted&&!autoLoadElem&&isLoading<3&&lowRuns<4&&loadMode>2&&(preloadElems[0]||lazySizesConfig.preloadAfterLoad)&&(preloadElems[0]||!elemExpandVal&&(eLbottom||eLright||eLleft||eLtop||lazyloadElems[i].getAttribute(lazySizesConfig.sizesAttr)!="auto"))){autoLoadElem=preloadElems[0]||lazyloadElems[i]}}if(autoLoadElem&&!loadedSomething){unveilElement(autoLoadElem)}}};var throttledCheckElements=throttle(checkElements);var switchLoadingClass=function(e){addClass(e.target,lazySizesConfig.loadedClass);removeClass(e.target,lazySizesConfig.loadingClass);addRemoveLoadEvents(e.target,switchLoadingClass)};var changeIframeSrc=function(elem,src){try{elem.contentWindow.location.replace(src)}catch(e){elem.setAttribute("src",src)}};var rafBatch=function(){var isRunning;var batch=[];var runBatch=function(){while(batch.length){batch.shift()()}isRunning=false};return function(fn){batch.push(fn);if(!isRunning){isRunning=true;rAF(runBatch)}}}();var unveilElement=function(elem){var sources,i,len,sourceSrcset,src,srcset,parent,isPicture,event,firesLoad,customMedia,width;var isImg=regImg.test(elem.nodeName);var sizes=isImg&&(elem.getAttribute(lazySizesConfig.sizesAttr)||elem.getAttribute("sizes"));var isAuto=sizes=="auto";if((isAuto||!isCompleted)&&isImg&&(elem.src||elem.srcset)&&!elem.complete&&!hasClass(elem,lazySizesConfig.errorClass)){return}if(isAuto){width=elem.offsetWidth}elem._lazyRace=true;isLoading++;rafBatch(function lazyUnveil(){if(elem._lazyRace){delete elem._lazyRace}removeClass(elem,lazySizesConfig.lazyClass);if(!(event=triggerEvent(elem,"lazybeforeunveil")).defaultPrevented){if(sizes){if(isAuto){addClass(elem,lazySizesConfig.autosizesClass);autoSizer.updateElem(elem,true,width)}else{elem.setAttribute("sizes",sizes)}}srcset=elem.getAttribute(lazySizesConfig.srcsetAttr);src=elem.getAttribute(lazySizesConfig.srcAttr);if(isImg){parent=elem.parentNode;isPicture=parent&&regPicture.test(parent.nodeName||"")}firesLoad=event.detail.firesLoad||"src"in elem&&(srcset||src||isPicture);event={target:elem};if(firesLoad){addRemoveLoadEvents(elem,resetPreloading,true);clearTimeout(resetPreloadingTimer);resetPreloadingTimer=setTimeout(resetPreloading,2500);addClass(elem,lazySizesConfig.loadingClass);addRemoveLoadEvents(elem,switchLoadingClass,true)}if(isPicture){sources=parent.getElementsByTagName("source");for(i=0,len=sources.length;i<len;i++){if(customMedia=lazySizesConfig.customMedia[sources[i].getAttribute("data-media")||sources[i].getAttribute("media")]){sources[i].setAttribute("media",customMedia)}sourceSrcset=sources[i].getAttribute(lazySizesConfig.srcsetAttr);if(sourceSrcset){sources[i].setAttribute("srcset",sourceSrcset)}}}if(srcset){elem.setAttribute("srcset",srcset)}else if(src){if(regIframe.test(elem.nodeName)){changeIframeSrc(elem,src)}else{elem.setAttribute("src",src)}}if(srcset||isPicture){updatePolyfill(elem,{src:src})}}if(!firesLoad||elem.complete){if(firesLoad){resetPreloading(event)}else{isLoading--}switchLoadingClass(event)}})};var onload=function(){if(isCompleted){return}var scrollTimer;var afterScroll=function(){lazySizesConfig.loadMode=3;throttledCheckElements()};isCompleted=true;lazySizesConfig.loadMode=3;lowRuns++;addEventListener("scroll",function(){if(lazySizesConfig.loadMode==3){lazySizesConfig.loadMode=2}clearTimeout(scrollTimer);scrollTimer=setTimeout(afterScroll,99)},true)};return{_:function(){lazyloadElems=document.getElementsByClassName(lazySizesConfig.lazyClass);preloadElems=document.getElementsByClassName(lazySizesConfig.lazyClass+" "+lazySizesConfig.preloadClass);defaultExpand=lazySizesConfig.expand;preloadExpand=Math.round(defaultExpand*lazySizesConfig.expFactor);addEventListener("scroll",throttledCheckElements,true);addEventListener("resize",throttledCheckElements,true);if(window.MutationObserver){new MutationObserver(throttledCheckElements).observe(docElem,{childList:true,subtree:true,attributes:true})}else{docElem.addEventListener("DOMNodeInserted",throttledCheckElements,true);docElem.addEventListener("DOMAttrModified",throttledCheckElements,true);setInterval(throttledCheckElements,999)}addEventListener("hashchange",throttledCheckElements,true);["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(name){document.addEventListener(name,throttledCheckElements,true)});if(/d$|^c/.test(document.readyState)){onload()}else{addEventListener("load",onload);document.addEventListener("DOMContentLoaded",throttledCheckElements);setTimeout(onload,25e3)}throttledCheckElements()},checkElems:throttledCheckElements,unveil:unveilElement}}();var autoSizer=function(){var autosizesElems;var sizeElement=function(elem,dataAttr,width){var sources,i,len,event;var parent=elem.parentNode;if(parent){width=getWidth(elem,parent,width);event=triggerEvent(elem,"lazybeforesizes",{width:width,dataAttr:!!dataAttr});if(!event.defaultPrevented){width=event.detail.width;if(width&&width!==elem._lazysizesWidth){elem._lazysizesWidth=width;width+="px";elem.setAttribute("sizes",width);if(regPicture.test(parent.nodeName||"")){sources=parent.getElementsByTagName("source");for(i=0,len=sources.length;i<len;i++){sources[i].setAttribute("sizes",width)}}if(!event.detail.dataAttr){updatePolyfill(elem,event.detail)}}}}};var updateElementsSizes=function(){var i;var len=autosizesElems.length;if(len){i=0;for(;i<len;i++){sizeElement(autosizesElems[i])}}};var throttledUpdateElementsSizes=throttle(updateElementsSizes);return{_:function(){autosizesElems=document.getElementsByClassName(lazySizesConfig.autosizesClass);addEventListener("resize",throttledUpdateElementsSizes)},checkElems:throttledUpdateElementsSizes,updateElem:sizeElement}}();var init=function(){if(!init.i){init.i=true;autoSizer._();loader._()}};(function(){var prop;var lazySizesDefaults={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:true,expFactor:2,expand:359,loadMode:2,throttle:125};lazySizesConfig=window.lazySizesConfig||window.lazysizesConfig||{};for(prop in lazySizesDefaults){if(!(prop in lazySizesConfig)){lazySizesConfig[prop]=lazySizesDefaults[prop]}}window.lazySizesConfig=lazySizesConfig;setTimeout(function(){if(lazySizesConfig.init){init()}})})();return{cfg:lazySizesConfig,autoSizer:autoSizer,loader:loader,init:init,uP:updatePolyfill,aC:addClass,rC:removeClass,hC:hasClass,fire:triggerEvent,gW:getWidth}});(function(){"use strict";var copyElements="copy-elements";$("[data-"+copyElements+"]").each(function(index,el){var $el=$(el);var elementsSelector=$el.data(copyElements);var elements=$(elementsSelector);$el.append(elements.clone())})})();(function(){"use strict";var running=false;var $window=$(window);var _refresh=function(){if($window.width()>700){$("[data-possible-scrollmation]").each(function(){this.removeAttribute("data-possible-scrollmation");new window.SectionScrollmation.ImageScrollmation({el:this,isBackground:false})})}else{}};var tick=function(){if(!running){window.requestAnimationFrame(_refresh)}running=true};_refresh();$window.on("resize",tick);$window.scroll()})();(function($,window,document){"use strict";var pluginName="social-widgets";var $window=$(window);var config={services:{facebook:{counterUrl:"https://graph.facebook.com/fql?q=SELECT+total_count+FROM+link_stat+WHERE+url%3D%22{url}%22&callback=?",convertNumber:function(data){if(!data||!data.data){return 0}return data.data[0]?data.data[0].total_count:0},shareAction:"Share",popupUrl:"https://www.facebook.com/dialog/feed?app_id={appId}&display=popup&caption={title}&link={url}&redirect_uri={redirectUrl}",popupWidth:600,popupHeight:420},twitter:{counterUrl:"https://cdn.api.twitter.com/1/urls/count.json?url={url}&callback=?",convertNumber:function(data){return data.count||0},shareAction:"Tweet",popupUrl:"https://twitter.com/intent/tweet?url={url}&text={title}",popupWidth:600,popupHeight:250}}};function SocialWidgets(options,containerEl){this.$containerEl=containerEl?$(containerEl):null;this.setup(options)}SocialWidgets.prototype={setup:function(){var self=this;var services=this.$containerEl.find(".social-widget");var showCounts=this.$containerEl.data("social-counts")===false?false:true;var isEnabled=this.$containerEl.data("social-shares")===false?false:true;var serviceTypeAttr="data-social-service";var redirectUrl=this.$containerEl.data("social-redirect")||encodeURI(location.href);$(services).each(function(index,el){var $el=$(el);var serviceType=$el.attr(serviceTypeAttr);var serviceId=$el.attr("data-social-id");if(!config.services.hasOwnProperty(serviceType)){return}var url=$el.data("social-url")||self.$containerEl.data("social-url");var title=$el.data("social-text")||self.$containerEl.data("social-text");var service=config.services[serviceType];var shareText=$el.attr("data-share-action")||service.shareAction;var shareUrl=self.getUrl(service.popupUrl,{url:url,title:title,appId:serviceId,redirectUrl:redirectUrl});$el.removeAttr(serviceTypeAttr).addClass("widget-"+serviceType);$el.append(self.createShareButton(serviceType,service,shareText,shareUrl,isEnabled));if(showCounts){var countUrl=self.getUrl(service.counterUrl,{url:url});self.createCountButton(countUrl,service.convertNumber,service,shareText,shareUrl,isEnabled,function(count,button){$el.append(button)})}})},getUrl:function(url,context){return url.replace(/\{([^\}]+)\}/g,function(m,key){return key in context?encodeURIComponent(context[key]):m})},createShareButton:function(serviceType,service,shareText,shareUrl,isEnabled){var self=this;var noLink=["javascript",":void(0);"].join("");var $shareContainerElement=$(document.createElement("div")).addClass("btn-social");var $shareLinkElement=$(document.createElement("a")).addClass("social-share-link").attr("href",noLink).text(" "+shareText);if(isEnabled){$shareLinkElement.on("click",function(){self.showPopup(shareUrl,service)})}var $shareImageElement=$(document.createElement("img")).addClass("iconic iconic-md iconic-active").attr("data-src","./static/img/"+serviceType+".svg");return $shareContainerElement.append($shareLinkElement.prepend($shareImageElement))},createCountButton:function(countUrl,converter,service,shareText,shareUrl,isEnabled,next){var self=this;var $counterContainerElement=$(document.createElement("div")).addClass("social-count");var $counterLinkElement=$(document.createElement("a")).addClass("social-count-link").attr("href",["javascript",":void(0);"].join(""));if(isEnabled){$counterLinkElement.on("click",function(){self.showPopup(shareUrl,service)})}$.getJSON(countUrl).done(function(data){var count=converter(data);var base=Math.floor(Math.log(Math.abs(count))/Math.log(1e3));var suffix="kmb"[base-1];count=suffix?String(count/Math.pow(1e3,base)).substring(0,3)+suffix:""+count;$counterLinkElement.text(count);next(count,$counterContainerElement.append($counterLinkElement))})},showPopup:function(url,options){var left=Math.round(screen.width/2-options.popupWidth/2);var top=0;if(screen.height>options.popupHeight){top=Math.round(screen.height/3-options.popupHeight/2)}var popupOptions=[["left",left].join("="),["top",top].join("="),["width",options.popupWidth].join("="),["height",options.popupHeight].join("="),["personalbar",0].join("="),["toolbar",0].join("="),["scrollbars",1].join("="),["resizable",1].join("=")].join(",");var win=window.open(url,"social-widget-"+options.shareText,popupOptions);if(win){win.focus()}else{location.href=url}}};$.fn.socialWidgets=function(options){if(this===$window){return new SocialWidgets(options,null)}var instance=null;this.each(function(){instance=$.data(this,"plugin_"+pluginName);if(!instance){instance=new SocialWidgets(options,this);$.data(this,"plugin_"+pluginName,instance)}else{instance.setup(options)}});return instance};$(function(){$("[data-social-widgets]").socialWidgets()});window.SocialWidgets=SocialWidgets})(jQuery,window,document);(function(ga){"use strict";ga=ga||function(){};$(function(){var sectionVisibilities=[];var MIN_LINGER=5e3;var sectionTypes=[];var getSectionType=function($el){if($el.hasClass("scrollmation-background")){return"scrollmation-background"}else if($el.hasClass("scrollmation-two-column")){return"scrollmation-two-column"}else if($el.hasClass("section-text")){return"text"}else if($el.hasClass("section-text-over-image")){return"text-over-image"}else if($el.hasClass("section-text-over-video")){return"text-over-video"}else if($el.hasClass("section-title")){return"title"}else if($el.hasClass("section-media-image")){return"image"}else if($el.hasClass("section-media-video")){return"video"}else if($el.hasClass("section-html")){return"custom-html"}else{return"unknown-section-type"}};$(".section:not(.section-header)").each(function(i){var $section=$(this);sectionVisibilities[i]=false;sectionTypes[i]=getSectionType($section);$section.data("tracking","true");var scrollWatch=$section.scrollWatch();scrollWatch.visibility=false;scrollWatch.on("scroll",function(e){if(Math.abs(e.visibility)>.8&&!sectionVisibilities[i]){sectionVisibilities[i]=true;if(this.data("tracking")==="true"){this.data("linger-start",Date.now());var sectionNumber=i+1<10?"0"+(i+1):i+1;var section=sectionNumber+"-"+this.attr("id");ga("shorthand.send","event",section,"scrolled")}}else if(Math.abs(e.visibility)<=.8&&sectionVisibilities[i]){sendLingerTime.call($section);sectionVisibilities[i]=false}});var sendLingerTime=function(){if(this.data("tracking")==="true"&&this.data("linger-start")){var lingerStart=parseInt(this.data("linger-start"));var lingerTime=Date.now()-lingerStart;if(lingerTime>=MIN_LINGER){this.removeData("linger-start");var id=this.attr("id");var sectionNumber=i+1<10?"0"+(i+1):i+1;var sectionType=sectionTypes[i];var section=sectionNumber+"-"+id;ga("shorthand.send","event",sectionType,"linger",section,lingerTime)}}};$section.on("unload",sendLingerTime)});$(".section-title").data("linger-start",Date.now())})})(window.ga);window.videoPlayerEventBus=$(".section-media-youtube, .section-media-video");(function(){"use strict";window.YoutubePlayerController=function(options){_.bindAll(this);this.$el=$(options.el);this.el=this.$el[0];this.player=options.player;this.vent=options.vent;this.initialize()};window.YoutubePlayerController.prototype={initialize:function(){this.vent.on("play",this.onOtherVideoPlay)},onOtherVideoPlay:function(event,videoSection){if(videoSection!==this.el){this.player.pauseVideo()}}}})();window.onYouTubePlayerAPIReady=function(){"use strict";return function(){var youtubeiFramesFound=$(".section-media-youtube iframe, .media-block-youtube iframe");if(youtubeiFramesFound){youtubeiFramesFound.each(function(){var el=$(this).parent(".section-media-youtube")[0];var onPlayerStateChange=function(event){if(event.data===1){window.videoPlayerEventBus.trigger("play",el)}};var player=new window.YT.Player(this.id,{events:{onStateChange:onPlayerStateChange}});new window.YoutubePlayerController({el:el,player:player,vent:window.videoPlayerEventBus})})}}}();(function(){"use strict";var youtubeiFramesFound=$(".section-media-youtube iframe, .media-block-youtube iframe");if(youtubeiFramesFound.length){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];
firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}})();(function($,videojs,Device){"use strict";function VideoPlayerSection(options){_.bindAll(this);this.$el=$(options.el);this.el=this.$el[0];this.$caption=this.$el.find("[data-video-player-caption]");this.$video=this.$el.find(".video-js");this.vent=options.vent;this.initialize()}VideoPlayerSection.prototype={initialize:function(){this.$el.addClass("is-not-playing is-inactive");this.player=videojs(this.$video[0]);this.player.ready(this.onVideoReady);this.vent.on("play",this.onOtherVideoPlay.bind(this));if(Device.isiOS()){this.setupVideoScaler()}var $videojs=this.$el.find(".video-js");if(this.$el.hasClass("section-media-video")){$videojs.css({height:"100%",width:"100%"})}if($videojs.hasClass("lazyload")||$videojs.hasClass("lazyloaded")){this.$el.find(".vjs-tech").addClass("lazyload")}},onOtherVideoPlay:function(event,videoSection){if(this.$el[0]!==videoSection){this.player.pause()}},onVideoReady:function(){this.player.on("pause",this.onVideoPause);this.player.on("play",this.onVideoPlay);this.player.on("useractive",this.onUserActive);this.player.on("userinactive",this.onUserInactive)},onVideoPause:function(){this.$el.addClass("is-not-playing")},onVideoPlay:function(){this.vent.trigger("play",this.$el);this.$el.removeClass("is-not-playing")},onUserActive:function(){this.$el.removeClass("is-inactive")},onUserInactive:function(){this.$el.addClass("is-inactive")},setupVideoScaler:function(){this._scaleVideo();$(window).on("resize orientationchange",this._scaleVideo)},_scaleVideo:function(){fastdom.read(function(){var sectionWidth=this.el.offsetWidth;var videoRatio=Math.max(this.$video.data("ratio"),1);var $video=this.$el.find("video");var videoHeight=sectionWidth/videoRatio;if(!Shorthand.helpers.isPortrait()){videoHeight=this.el.offsetHeight}fastdom.write(function(){$video.width(sectionWidth).height(videoHeight);this.player.height(videoHeight)},this)},this)}};$("[data-video-player]").each(function(){new VideoPlayerSection({el:this,vent:window.videoPlayerEventBus})})})($,window.videojs,window.Device);(function(ViewportHeight,Device){"use strict";function getFixedStoryElementHeight(){var viewportHeight=new ViewportHeight(document.body);return viewportHeight.getFixedElementsHeight()}$(function(){var $html=$("html, body");var $nav=$(".section-navigation");function activateItem($el){$nav.find(".active").removeClass("active");$el.addClass("active")}function stick(){$nav.addClass("stick")}function unstick(){$nav.removeClass("stick")}function setProblemChildren(el,styles,problemChildren){_.each(styles,function(style){if(el.style[style.name]===style.original||style.original==="*"&&el.style[style.name].length>0){problemChildren.push({el:el,name:style.name,original:el.style[style.name]});el.style[style.name]=style.replacement}})}function jumpingToTitle($targetSection){return $targetSection.hasClass("section-title")}function jumpToSection(event){event.preventDefault();var $anchor=$(event.delegateTarget);var navigationLinks=$("a[href^=#].section-navigator");if($anchor.data("currently-scrolling")!==true){navigationLinks.data("currently-scrolling",true);var $targetSection=$($anchor.attr("href"));var fixedElementHeight=getFixedStoryElementHeight();var sectionTop=$targetSection.offset().top;var scrollOffset=Math.ceil(sectionTop-fixedElementHeight);if(jumpingToTitle($targetSection)){scrollOffset=0}var $sections=$(".section");if(Device.isMobile()){$sections.data("tracking","true");var items=document.getElementsByTagName("*");var problemChildren=[];var styles=[{name:"position",original:"fixed",replacement:"absolute"},{name:"-webkit-transform",original:"*",replacement:"none !important"}];for(var i=items.length;i--;){var el=items[i];setProblemChildren(el,styles,problemChildren)}$html.scrollTop(scrollOffset);_.defer(function(){$anchor.blur();_.each(problemChildren,function(problemChild){problemChild.el.style[problemChild.name]=problemChild.original});navigationLinks.data("currently-scrolling",false)})}else{$sections.data("tracking","false");$targetSection.data("tracking","true");$html.stop().animate({scrollTop:scrollOffset},1500).promise().done(function(){$sections.data("tracking","true");navigationLinks.data("currently-scrolling",false);activateItem($anchor);$anchor.blur()})}}}$(".sections-list .section").each(function(){if(!Device.isMobile()){var $el=$(this);var id=$el.attr("id");var $navEl=$nav.find('[href="#'+id+'"]');if($navEl.length===1){$el.scrollWatch().on("scroll",function(e){var visibility=Math.abs(e.visibility);if(visibility>.8){activateItem($navEl)}else if(visibility===0&&e.direction==="up"&&$navEl.hasClass("active")){activateItem($navEl.prev())}})}}});$(".section-header").scrollWatch().on("scroll",function(e){var visibility=Math.abs(e.visibility);if(visibility>0||Device.isMobile()&&!Device.isAndroidTablet()){unstick()}else{stick()}});$("a[href^=#].section-navigator").on("click",jumpToSection)})})(window.ViewportHeight,window.Device);(function(){"use strict";function showWhenLoaded(video){var events=["loadeddata","playing","canplaythrough"];var showVideo=function(){video.style.opacity=1};for(var i in events){video.addEventListener(events[i],showVideo)}}function visibilityCheck(visibility,video){if(visibility>.2){if(video.canPlayType){video.play()}}if(visibility<.2){if(video.canPlayType){video.pause()}}}function sectionInViewport($el,visibility){var video=$el.find("video")[0];if(video){showWhenLoaded(video);visibilityCheck(visibility,video)}}function backgroundScrollmationVideoInViewport($el,visibility){if($el[0].className.indexOf("active")!==-1){var video=$el.find("video")[0];if(video){showWhenLoaded(video);visibilityCheck(visibility,video)}}}$(".section-text-over-media, .section-title").each(function(){$(this).scrollWatch().on("scroll",function(e){var visibility=Math.abs(e.visibility);sectionInViewport($(this),visibility)})});$(".scrollmation-background-container [data-video-background-container]").each(function(){$(this).scrollWatch().on("scroll",function(e){var visibility=Math.abs(e.visibility);backgroundScrollmationVideoInViewport($(this),visibility)})})})();(function($){"use strict";var $window=$(window);function resizing(element){var $el=$(element);var videoElement=$el.find(".video-js")[0];var mediaRatio=$el.data("mediaRatio");$window.on("resize",function(){var parentWidth=$el.width();videoElement.player.width(parentWidth);videoElement.player.height(parentWidth/mediaRatio)})}$(function(){$("[data-scroll-video-player]").each(function(){resizing(this)})})})($);(function(){"use strict";$(function(){function navigationToggle(e){$(".section-navigation").toggleClass("hide-when-small");$(".navigation .menu-overlay").toggleClass("show-with-menu");$(".section-header").toggleClass("menu-active");document.body.height=document.documentElement.clientHeight+"px";$("body").toggleClass("prevent-menu-scrolling");e.preventDefault()}$(".small-menu a, .navigation .menu-overlay").on("click",function(e){navigationToggle(e)});$(".navigation .menu-overlay").on("touchstart",function(e){navigationToggle(e)});$(".section-navigation a").on("click",function(e){$(".section-navigation").addClass("hide-when-small");$(".navigation .menu-overlay").removeClass("show-with-menu");$(".section-header").removeClass("menu-active");$("body").removeClass("prevent-menu-scrolling");e.preventDefault()})})})();(function(Device,Shorthand){"use strict";if(!Device.isMacRetinaChrome()){return}var backgroundImages=document.getElementsByClassName("text-over-media-background-image");var isPortraitModeOn=Shorthand.helpers.isPortrait();var portraitBackgroundImages=_.filter(backgroundImages,function(image){return image.dataset.portraitSrc&&image.dataset.portraitSrc.length>0});$(window).on("mousewheel scroll resize",function(){Shorthand.translateImages(backgroundImages)}).on("resize",function(){fastdom.read(function(){var isPortrait=Shorthand.helpers.isPortrait();if(isPortrait&&!isPortraitModeOn){_.each(portraitBackgroundImages,function(image){fastdom.write(function(){image.src=image.dataset.portraitSrc})});isPortraitModeOn=true}else if(!isPortrait&&isPortraitModeOn){_.each(portraitBackgroundImages,function(image){fastdom.write(function(){image.src=image.dataset.landscapeSrc})});isPortraitModeOn=false}})})})(window.Device,Shorthand);(function($){"use strict";$(function(){$(".header-social-collapse").click(function(){$(".header-social-panel").addClass("collapsed")});$(".header-social-expand").click(function(){$(".header-social-panel").removeClass("collapsed")})})})($)}).call(this)})(false);